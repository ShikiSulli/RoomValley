{% extends 'base.html.twig' %}

{% block title %}Roomvalley Calendar TEST
{% endblock %}

{% block javascripts %}
	{{ parent() }}
	<script src="https://cdn.jsdelivr.net/npm/fullcalendar-scheduler@6.1.9/index.global.min.js"></script>
{% endblock %}

{% block body %}

  <div class="container">
		<div class="row">
			<div class="col-6" id="descriptionroomid"></div>
			<div class="col-6" id="calendar1">
			<form action="" method='post' class="text-center"> {# added text-center class #}
				
				<label for="date_start">Reservation pour le : </label>
				<input type="date" name="date_start" id="date_start">
				<br>
				<label for="date_end">Fin de Reservation pour le : </label>
				<input type="date" name="date_end" id="date_end">
				<br>
				<label for="nombre_jours">Nombre de Jours Reserver</label>
				<input type="text" name="nombre_jours" id="nombre_jours" readonly>
				<br>
				<input type="submit" name="submit" value="Valider les Dates" id="addToReservationButton" class="btn btn-success" disabled="disabled">
				
			</form>
			</div>
		</div>
    </div>
        

     <script>
document.addEventListener('DOMContentLoaded', function() {
    let isStartDateSelected = false;
    let startDate = '';
    const calendarEl = document.getElementById('calendar1');
    const dateStartInput = document.getElementById('date_start');
    const dateEndInput = document.getElementById('date_end');

    function updateNumberOfDays() {
        const dateStart = new Date(startDate);
        const dateEnd = new Date(dateEndInput.value);

        // Calculer la différence en millisecondes entre les dates
        const differenceEnMilliseconds = dateEnd - dateStart;

        // Convertir la différence de millisecondes en jours
        const differenceEnJours = differenceEnMilliseconds / (1000 * 60 * 60 * 24);

        // Afficher le nombre de jours entre les deux dates dans l'input
        document.getElementById('nombre_jours').value = differenceEnJours + 1;
    }

    const calendar = new FullCalendar.Calendar(calendarEl, {
        themeSystem: 'bootstrap5',
        initialView: 'dayGridMonth',
        timeZone: 'Europe/Paris',
        locale: 'fr',
        selectable: true,
        headerToolbar: {
            left: 'prev,next',
            center: 'title',
            right: 'prevYear,nextYear'
        },
        select: function(info) {
            if (!isStartDateSelected) {
                startDate = info.startStr;
                dateStartInput.value = startDate;
                isStartDateSelected = true;
            } else {
                const endDate = info.startStr;
                dateEndInput.value = endDate;
                isStartDateSelected = false;
                updateNumberOfDays(); // Met à jour le nombre de jours quand date_end est sélectionné
            }
        }
    });

    // Écoutez l'événement 'input' pour les champs de date
    dateStartInput.addEventListener('input', function() {
        startDate = dateStartInput.value;
        updateNumberOfDays(); // Met à jour le nombre de jours dès que date_start est modifié
    });

    dateEndInput.addEventListener('input', function() {
        updateNumberOfDays(); // Met à jour le nombre de jours dès que date_end est modifié
    });

    calendar.render();
});

</script>



{% endblock %}
